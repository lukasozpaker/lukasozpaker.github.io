<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width" />
    <!--------------------------------------------->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <!--------------------------------------------->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.0.0/core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.0.0/sha256.min.js"></script>
    <!--------------------------------------------->
    <link href="https://fonts.googleapis.com/css?family=DM+Sans&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=DM+Sans:700&display=swap" rel="stylesheet">
    <!--------------------------------------------->
    <title>CSGO map voting</title>
    <style>
      @font-face {
        font-family: GilroyLight;
        src: url("https://www.ozpaker.org/Gilroy-Light.otf") format("opentype");
      }
      @font-face {
        font-family: GilroyBold;
        src: url("https://www.ozpaker.org/Gilroy-ExtraBold.otf") format("opentype");
      }
      @font-face {
        font-family: ObjectSans;
        src: url("https://www.ozpaker.org/ObjectSans-Regular.otf") format("opentype");
      }
      ::selection{
        color: #ffffff;
        background-color: rgba(0,10,18,0.99);
      }
      html{
        -webkit-tap-highlight-color: rgba(0,0,0,0);
      }
      body{
        margin: 0;
      }
      *{
        transition: ease-out 0.3s;
        box-sizing: border-box;
      }
      input:focus {
        outline: none;
        outline: 0;
        border: 4px solid #404044;;
        border-radius: 2px;
      }
      *:focus::placeholder {
        color: transparent;
        transition: ease-out 0.3s;
      }
      a{
        text-decoration: none;
        color: #26a69a;
        font-family: 'GilroyBold', monospace;
        font-size: 14px;
      }

      #wrapper{
        display: block;
        font-family: 'GilroyBold', 'Arial', monospace;
        position: absolute;
        top: 50%;
        transform: translate(-50%, -70%);
        left: 50%;
        width: 80%;
      }
      #welcome{
        text-align: center;
        padding: 2em;
        font-size: 24px;
      }
      input {
        font-family: 'GilroyLight', 'ObjectSans', 'Arial', monospace;
        border: none;
        width: 100%;
        height: 50px;
        font-size: 40px;
        text-align: center;
        margin: 0;
        box-sizing: border-box;
        padding: 1em;
        border: 4px solid #707075;
      }
      ::placeholder{
        text-align: center;
      }


      /*
      * CSGO map form
      *
      */

      #form{
        display: none;
      }
      #TITLE{
        font-family: 'GilroyBold', 'Arial', monospace;
        text-align: center;
        padding-top: 1.5em;
        font-size: 24px;
      }
      ul {
        list-style-type: none;
        margin: auto;
        padding: 3em;
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(14em, 1fr));
        grid-auto-rows: auto;
        grid-column-gap: 5em;
        grid-row-gap: 5em;
      }

      li {
        display: inline-block;
      }

      input[type="checkbox"][id^="map"] {
        display: none;
      }

      label {
        border: 0 solid #ffffff;
        padding: 0;
        display: list-item;
        position: relative;
        margin: auto;
        cursor: pointer;
        background-color: #26a69a;
      }

      label img {
        object-fit: cover;
        width: 100%;
        height: 20em;
        max-height: 100%;
        transition: ease 0.3s;
        transform-origin: 50% 50%;
        vertical-align: middle;
      }

      :checked + label img {
        transform: scale(0.9);
        z-index: -1;
      }

      #footer {
        display: none;
        font-family: 'ObjectSans', monospace;

        left: 0;
        bottom: 0;
        text-align: center;

        padding-bottom: 1.5em;
        overflow: auto;
        letter-spacing: 0.05em;
        font-size: 0.9em;
      }
      .vers {
        float: left;
        padding-left: 3.5em;
      }
      .info {
        float: right;
        padding-right: 3.5em;
      }
      #title {
        font-family: 'GilroyBold', 'Arial', monospace;
        color: #ffffff;
        text-align: center;
        padding: 0.5em;
        font-size: 16px;
        background-color: #404044;
      }
      </style>
  </head>
  <body>

    <div id="wrapper">
      <header id="welcome">WELCOME TO THE CSGO ONLINE VOTING SYSTEM</header>
      <input id="password" type="password" placeholder="Password" />
      <a href="https://www.ozpaker.org/results">VIEW RESULTS</a>
    </div>

    <div id="form">
      <header id="TITLE">MAP POOL</header>
      <ul>
        <li><input type="checkbox" id="map0" />
          <label for="map0"><img src="https://i.redd.it/b32uegcv66jz.jpg" /></label>
          <header id="title">MIRAGE<header>
        </li>
        <li><input type="checkbox" id="map1" />
          <label for="map1"><img src="https://i.redd.it/10zd55ckhba01.jpg" /></label>
          <header id="title">INFERNO<header>
        </li>
        <li><input type="checkbox" id="map2" />
          <label for="map2"><img src="https://i.redd.it/opk068upvac41.jpg" /></label>
          <header id="title">OVERPASS<header>
        </li>
        <li><input type="checkbox" id="map3" />
          <label for="map3"><img src="https://pbs.twimg.com/media/ESXzzjrWAAYfr6B.jpg" /></label>
          <header id="title">VERTIGO<header>
        </li>
        <li><input type="checkbox" id="map4" />
          <label for="map4"><img src="https://i.imgur.com/HjHQyTK.jpg" /></label>
          <header id="title">NUKE<header>
        </li>
        <li><input type="checkbox" id="map5" />
          <label for="map5"><img src="https://epicplayz.pl/uploads/FrogMan/696.jpg" /></label>
          <header id="title">TRAIN<header>
        </li>
        <li><input type="checkbox" id="map6" />
          <label for="map6"><img src="https://pbs.twimg.com/media/DMhBxDnW4AE9BYa.jpg" /></label>
          <header id="title">DUST II<header>
        </li>
        <li><input type="checkbox" id="map7" />
          <label for="map7"><img src="https://vignette.wikia.nocookie.net/cswikia/images/5/54/De_anubis.png/revision/latest?cb=20200401081330" /></label>
          <header id="title">ANUBIS<header>
        </li>
        <li><input type="checkbox" id="map8" />
          <label for="map8"><img src="https://pbs.twimg.com/media/DF-4aUSXsAAIO30.jpg" /></label>
          <header id="title">CACHE<header>
        </li>
        <li><input type="checkbox" id="map9" />
          <label for="map9"><img src="https://assets.change.org/photos/3/bs/mf/GpbSMfhlnssoRFi-800x450-noPad.jpg?1526853546" /></label>
          <header id="title">AGENCY<header>
        </li>
        <li><input type="checkbox" id="map10" />
          <label for="map10"><img src="https://files.gamebanana.com/bitpit/2012-03-23_00001.jpg" /></label>
          <header id="title">OFFICE<header>
        </li>
        <li><input type="checkbox" id="map11" />
          <label for="map11"><img src="https://lh3.googleusercontent.com/zLeSc-zaKaFOtUt_afLp1zItMKd1JeT-ESg78VWXd6BLVQTxKgKkQKEL2YEQFNjaby3fF0Y_5ZMiQai66oSJoeWL23vbsnk19p0ku4b0eAldi--n3FpYSUBSD_ofPPzXnss5cG7byG1jt6ZtiNZgSvnjLBEvqP_Rp1b1nE16s7sAK5PxK_TqZy3Rm0pZTolwFgcVBFWUju9Aja-v8g20g4G8gqC0f_Vw77oEle6t4fsTnfyjdaW6JflDPE9ZLo880qrP7vNDmtab_gnTaWoc3RC7Zg8wVin-3GEHdTsPlHvFtAKO_tUt8ABBJuutIaYBtyq5jWbpR9yh7dEy2yUrpeg8rHsdjQCi7l0a20Fp5qfQRXVZrxW2Mu4AiD38ZpIAx4N9wagbeJ4q5WllfKMI64idc7awv25vC9XzM7dAUNMmj5qemyKlqQsadrwiOevtBpNuHBKP-cIOcGUYU4gvOdJ_bP9oDS7mEpjICq8xaqC8y4JDT6KDNZ8VBrF6gOI6Gh-4d49_WrcLanMqIPQEISFEQADuNcvtiU2345QB_BTsFGvv3aw0j9ffsexQX0Z3jxh9SZy10J3EkDxbjao62HCFOJmOS7RDStpaqDA0TdPfABQFYJiIAjc1rQsfXEm9xJkc4XIBGc9Op3Z2kX_z7eiQIZSLq7pvNtPJxLQQDNxTzT2kcug_i7y_PTCZ4UY=w696-h927-no?authuser=0" /></label>
          <header id="title">WILDCARD<header>
        </li>
      </ul>

    </div>

    <footer id="footer">
      <span class="vers">BETA 0 . 9</span>
      <span class="info">LUKAS OZPAKER 2020</span>
    </footer>

    <script type="text/javascript">
    //goes to
    //clickable 'radio button' map images
    //revote during next day 12am

    // Get the input field
    var password = document.getElementById("password");
    var portal = document.getElementById("wrapper");
    var form = document.getElementById("form");
    var footer = document.getElementById("footer");

//lukas, paul, can, esteban, felix
    var maps = [false, false, false, false, false, false, false, false, false, false];
    var hashes = [
      "848f106ca0039acc36440ad1e97f9014546435954b808f78cee0be5daa029e35",
      "8ce1870c006c8f442f6e0dacfaa3a29b505c2e8404e52aa44f8a8e85ddda2155",
      "796e43a5a8cdb73b92b5f59eb50610cea3efa8ce229cd7f0557983091b2b4552",
      "6f6b9c42907f57f1e42ec10b72c9fa3f8f1fa615557d283ed03ab1e106049a63",
      "7ef1cb0d6e975181c6d98abfc08d9ea358f4d4b55b25d8b966ed9ee56adaa99a"
    ];
    // Execute a function when the user releases a key on the keyboard
    //TODO: the style.display is broken, fix later
    document.addEventListener("keyup", function(event) {
      // Number 13 is the "Enter" key on the keyboard
      if (event.keyCode === 13 && portal.style.display !== "none") {
        // Cancel the default action, if needed
        event.preventDefault();
        // Trigger the button element with a click
        console.log("LOGIN INITIATED");
        console.log(password.value);
        var hash = CryptoJS.SHA256(password.value).toString(CryptoJS.enc.Hex);
        var correct = false;
        console.log(hash);

        for(let i=0;i<hashes.length;i++) {
          if (hash === hashes[i]) {
            console.log("LOGIN SUCCESSFUL");
            document.getElementById('password').style.border = '4px solid #26a69a';
            correct = true;
            window.setTimeout(function(){
              portal.style.display = "none";
              form.style.display = "block";
              footer.style.display = "block";
            }, 600);
          }
        }
        if(correct === false) {
          console.log("LOGIN FAILED");
          document.getElementById('password').style.border = '4px solid #d32f2f';
        }
      }
      else if (event.keyCode === 13 && form.style.display !== "none") {
        // Cancel the default action, if needed
        event.preventDefault();
        // Trigger the button element with a click
        console.log("FORM COMPLETED");
        maps[0] = document.getElementById('map0').checked;
        maps[1] = document.getElementById('map1').checked;
        maps[2] = document.getElementById('map2').checked;
        maps[3] = document.getElementById('map3').checked;
        maps[4] = document.getElementById('map4').checked;
        maps[5] = document.getElementById('map5').checked;
        maps[6] = document.getElementById('map6').checked;
        maps[7] = document.getElementById('map7').checked;
        maps[8] = document.getElementById('map8').checked;
        maps[9] = document.getElementById('map9').checked;
        maps[10] = document.getElementById('map10').checked;

        if(document.getElementById('map11').checked) {
          var indexes = [];
          var wildcardmap;
          for(let i=0;i<maps.length;i++){
            if (maps[i]) {
              indexes.push(i);
            }
          }

          if(indexes[0] == undefined) {
            console.log("No maps chosen");
            wildcardmap = Math.floor(Math.random() * 11);
          }
          else {
            console.log("selected: " + indexes);
            //index of the map pick that is going to change
            var metaindex =  Math.floor(Math.random() * indexes.length);
            var toBeReplaced = indexes[metaindex];
            console.log("toBeReplaced: " + toBeReplaced);

            //index of a random map that wasn't already picked (can't be the one replaced either)
            wildcardmap = Math.floor(Math.random() * 11); //returns a random integer from 0 to 10
            while (indexes.includes(wildcardmap)) {
              wildcardmap = Math.floor(Math.random() * 11);
            }
          }
          console.log("wildcardMap: " + wildcardmap);

          maps[toBeReplaced] = false;
          maps[wildcardmap] = true;
        }

        //hash;
        //maps;
        var date = new Date();
        var year = date.getFullYear();
        var month = date.getMonth() + 1;
        var day = date.getDate();
        console.log(year +" " + month + " "+ day);



        results = [{"hash":hash,},
          {"map0":maps[0], "map1":maps[1], "map2":maps[2], "map3":maps[3],
        "map4":maps[4], "map5":maps[5], "map6":maps[6], "map7":maps[7],
        "map8":maps[8], "map9":maps[9], "map10":maps[10]}
      ];

        console.log(results);
      }
    });

    // [0] mirage
    // [1] inferno
    // [2] overpass
    // [3] vertigo
    // [4] nuke
    // [5] train
    // [6] dust II
    // [7] anubis
    // [8] cache
    // [9] agency
    // [10] office
    </script>
  </body>
</html>
